# Experimaestro SLURM launcher configuration
# Cluster: {{ cluster_name }}
# Generated by: experimaestro launchers slurm generate
#
# Edit this file to change partition settings, then run:
#   experimaestro launchers slurm generate --from-config {{ config_file }}
#
# To regenerate from scratch (re-detect cluster):
#   experimaestro launchers slurm generate --force

cluster_name: {{ cluster_name }}
default_account: {{ default_account | default('null', true) }}
consider_priority: {{ consider_priority | lower }}

# Partitions configuration
# - priority: higher = preferred when multiple partitions match
# - qos: SLURM QoS to use (null = use SLURM default)
# - gpu_memory_gb: GPU memory in GB (for matching requirements)
partitions:
{% for p in partitions %}
  {{ p.name }}:
    enabled: {{ p.enabled | lower }}
    priority: {{ p.priority }}
    cpus: {{ p.cpus }}
    memory_gb: {{ (p.memory_bytes / (1024**3)) | round(1) }}
    gpus: {{ p.gpus }}
    gpu_type: {{ p.gpu_type | default('null', true) }}
    gpu_memory_gb: {{ (p.gpu_memory_bytes / (1024**3)) | round(0) | int if p.gpu_memory_bytes else 0 }}
    time_limit_seconds: {{ p.time_limit_seconds }}
    qos: {{ p.qos | default('null', true) }}
{% endfor %}
